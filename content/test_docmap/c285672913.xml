<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE concept PUBLIC "-//OASIS//DTD DITA Concept//EN" "concept.dtd">
				<concept CreatedForRelease="CMM18.5" NetworkElement="CMM" rev="CMM21.8" id="concept_flk_wjc_jtb"><title>3G subscribers offload process</title><shortdesc> This process allows the operator to put SGSN (source) under maintenance and offload        a subset of subscribers to the active SGSN (target) in multipoint Iu pool        environment.</shortdesc><prolog><author>ANASTASIA CHATZIAGAPOGLOU</author></prolog><conbody><p>Phase 1 refers to the attached 3G subscribers without active PDP. <parmname>enhOfflIdleSubsRate</parmname> PRFILE parameter is used to control            the subscribers offloading rate in this phase. The operator may control the target SGSN                (<parmname>subsNri </parmname>parameter), the percentage of            subscribers to be offloaded (<parmname>subsOffPercentage</parmname>            parameter) through the <cmdname>cmm subsOffloadTarget</cmdname> command. </p><p>The transfer of subscribers utilizes a P-TMSI reallocation procedure due to new            NRI which identifies the target SGSN and is included in P-TMSI. <cmdname>cmm maintenance create</cmdname> command triggers the procedure below:</p><p>            <fig><title>Flow of offload process for 3G subscribers phase-1 </title><image href="Subscribers attached without PDP context.svg" CreatedForRelease="CMM18.5"/></fig>        </p><ul><li>UE initiates the attach procedure by the transmission of an Attach Request message                to the Old SGSN.</li><li>Old SGSN sends an Attach Accept message to the UE after required verifications.</li><li>Old SGSN initiates IU Release request message to the RNC to release its                resources.</li><li>RNC replies to the Old SGSN with IU Release response message.</li><li>Offloading is activated by the <cmdname>cmm                    maintenance</cmdname> command.</li><li>SGSN sends a Paging message to the RNC (the RNC pages the MS) so as to establish a                new connection after IU release.</li><li>UE acknowledges the request sent by Old SGSN by sending Service Request (P-TMSI,                RAI).</li><li>Old SGSN initiates P-TMSI Reallocation command to the UE to get the New P-TMSI                (due to new NRI which identifies the target SGSN and is included in P-TMSI) and Old                SGSN’s non broadcast RAI.</li><li>UE sends the P-TMSI Reallocation complete to the Old SGSN.</li><li>The UE sends a Routing Area Update Request to the New SGSN (old NB RAI, old                P-TMSI Signature).</li><li>The new SGSN sends SGSN Context Request to the Old SGSN to get the MM and PDP                contexts for the RNC (old RAI, old P-TMSI Signature, New SGSN Address).<ul><li>New SGSN uses Non-Broadcast RAI which exists in old RAI parameter in RAU message                        to identify the old SGSN IP address. It indicates that Non-Broadcast RAI                        (RAC, LAC, MCC, MNC) based APN should be configured in DNS Server.</li><li>DNS Server should contain Non-broadcast RAI APN configured for offloading                        SGSN, so that Target SGSN which receives RAU message identifies the old SGSN                        based on Non-Broadcast RAI.</li></ul></li><li>The Old SGSN sends SGSN context Response to the New SGSN (MM Context, PDP Contexts).                The Old SGSN stores New SGSN’s Address, to allow the old SGSN to forward data to the                New SGSN.</li><li>The New SGSN sends an SGSN Context Acknowledge message to the Old SGSN. This informs                Old SGSN that the new SGSN is ready to receive data belonging to the activated PDP                contexts.</li><li>The New SGSN validates RNC in the new routing area and sends Routing Area Accept                message to UE.</li><li>The UE acknowledges the new P-TMSI by returning a Routing Area Update Complete                message to the new SGSN.</li></ul><p>Phase 2 refers to attached 3G subscribers with active PDP. The operator may            control the target SGSN  (<parmname>subsNri</parmname> parameter), the percentage of            offload (<parmname>subsoffPercentage</parmname> parameter) and the rate                (<parmname>subsOffrate</parmname> parameter) through the <cmdname>cmm                subsOffloadTarget</cmdname> command.</p><p>Parameter Offload rate (<parmname>subsOffrate</parmname> parameter) in            target SGSN record is used to control the rate of offloading of subscribers attached            with PDP context. Supported functionality functions only between CMM SGSNs as it has            proprietary private extensions.</p><p>The transfer of subscribers utilizes a P-TMSI reallocation procedure due to new            NRI which identifies the target SGSN and is included in P-TMSI. <cmdname>cmm maintenance create </cmdname> command triggers the procedure as described            below:</p><fig><title>Flow of offload process for 3G subscribers phase-2 </title><image href="v285672993" rev="CMM21.8"/></fig><ul><li>UE initiates an Attach Request to Old SGSN.</li><li>Old SGSN accepts the Attach Request from UE and sends back a response for the                same.</li><li>Upon the receipt of attach signal, PDP Context activation request is initiated from                UE to old SGSN.</li><li>SGSN activates PDP or Bearer by sending create PDP Context Request (for GGSN) or                Create Session Request (for SGW).</li><li>PDP Context Response is sent from GGSN to Old SGSN indicating that a PDP context                creation is done.</li><li>PDP Context activation is successfully done and response is sent from old SGSN to                UE.</li><li>Offloading is activated by the <cmdname>cmm maintenance</cmdname> command.</li><li>Forward relocation request from old SGSN to the new SGSN with private extension                parameters for offloaded subscribers count value.<ul><li>In offloading SGSN, target NRI's are configured with                            <cmdname>cmm subsOffloadTarget create</cmdname> command.                        Target NRI along with current RAC/LAC are used to frame NRI FQDN and Target                        SGSN IP address identified. DNS Server should be configured with this NRI                        FQDN.</li></ul></li><li>New SGSN in turn requests GGSN to update PDP context request. GGSN sends a response                for updated PDP context to the New SGSN. In case of SGW, modify bearer request is                sent and response is obtained for the same.</li><li>Forward relocation response command is triggered from new SGSN to old SGSN                including new PTMSI allocated and new SGSN Non-Broadcast RAI in private                extension.</li><li>Upon reception of forward relocation response, old SGSN sends P-TMSI                Reallocation command with new SGSN Non Broadcast RAI to UE and new P-TMSI                allocated.</li><li>P-TMSI Reallocation is completed and UE acknowledges back to old SGSN with P-TMSI                reallocation complete command.</li><li>Upon receiving the P-TMSI Reallocation Complete message, old SGSN sends forward                relocation complete acknowledge signal to new SGSN mentioning that forward                relocation is done.</li><li>Upon receiving the P-TMSI Reallocation Complete message, old SGSN also triggers an                IU Release command to the RNC. After IU Release is done, RNC signals an IU Release                complete command to old SGSN.</li><li>Upon the receipt of forward relocation complete acknowledge, new SGSN updates                location to HLR with update location command.</li><li>HLR sends a cancel location command to old SGSN which old SGSN acknowledges. </li><li>Upon the cancel location acknowledgment command, HLR gives the subscriber data to                new SGSN and obtains the response for the same.</li><li>Over this cancel location acknowledgment, HLR sends an update location                acknowledgment signal to the new SGSN.</li><li>New SGSN sends the Paging message to the RNC (the RNC pages the MS) so as to                establish a new connection with new SGSN. MS initiated service request procedure for                new SGSN.</li><li>Routing Area Update session begins here with UE initiating RAU request to new                SGSN.</li><li>New SGSN signals RNC with RAU accept command.</li><li>UE signals the new SGSN with RAU complete notifying that routing area update is                done.</li></ul></conbody></concept>